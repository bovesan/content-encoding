<!doctype html>
<html lang=en>
<head>
<meta charset=utf-8>
<title>Content-Encoding test</title>
<style>
pre,
#resource {
	background: #eee;
	padding: 1em;
	color: #555;
}
button {
	cursor: pointer;
	border-style: none;
	font-size: 166%;
}
button,
.response {
	padding: 1em;
	background: #089;
	color: white;
}
</style>
</head>
<body>
<a href="https://github.com/bovesan/content-encoding">https://github.com/bovesan/content-encoding</a>
<h4>Source</h4>
<pre id="scriptsource"></pre>
<button onclick="test();">Run test</button>
<h4>Response</h4>
<pre id="gzip"></pre>
<h4>curl equivalent</h4>
<pre id="info"></pre>
<h4>Resource source</h4>
<div id="resource">Not loaded</div>
<script lang="text/javascript" id="script">function test(){
	document.getElementById('gzip').classList.add('response');
	document.getElementById('gzip').innerHTML = 'Testing XMLHttpRequest';
	const xhr = new XMLHttpRequest();
	xhr.addEventListener('load', event => {
	    document.getElementById('gzip').innerHTML = event.target.response;
	    console.log(event.target.response);
	});
	xhr.open('GET', 'resource');
	xhr.send();
}
</script>
<script lang="text/javascript">
const xhr = new XMLHttpRequest();
xhr.addEventListener('load', event => {
    document.getElementById('resource').innerHTML = event.target.response;
    console.log(event.target.response);
});
xhr.open('GET', 'source.php');
xhr.send();
document.getElementById('scriptsource').innerHTML = document.getElementById('script').innerHTML;
document.getElementById('info').innerHTML = 'curl -H "Accept-Encoding: gzip" '+window.location.href+'resource | gunzip ';
</script>
</body>
</html>